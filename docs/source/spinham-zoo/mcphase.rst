.. _zoo_mcphase:

*******
McPhase
*******

========= ======================================================================
========= ======================================================================
Status    Draft
Links     `Web <https://mcphase.github.io/webpage/>`_
Languages C++, Fortran, Perl, Java
========= ======================================================================

Spin Hamiltonian
================ 

The spin Hamiltonian is in general:

.. math::

    \hat{\mathcal{H}}
    =
    \sum_{n=1}^{N}
    \hat{\mathcal{H}}(n)
    -
    \dfrac{1}{2}
    \sum_{n,n^{\prime},\alpha,\beta}
    \mathcal{J}_{\alpha,\beta}(\mathbf{R}_{n^{\prime}} - \mathbf{R}_{n})
    \hat{\mathcal{I}}_{\alpha}^n
    \hat{\mathcal{I}}_{\beta}^{n^{\prime}}

The first term :math:`\hat{\mathcal{H}}(n)` denotes the Hamiltonian of a
subsystem :math:`n` (e. g. an ion, or cluster of ions). The second term
describes a bilinear interaction between different subsystems through the
operators
:math:`\hat{\mathcal{I}}_{\alpha}^n`,
with
:math:`\alpha = 1, 2, \dots, M`.
The operators
:math:`\hat{\mathcal{H}}(n)`
and
:math:`\hat{\mathcal{I}}_{\alpha}^n`
act in the subspace :math:`n` of the Hilbert space, i. e. 
:math:`[\hat{\mathcal{I}}_{\alpha}^n, \hat{\mathcal{I}}_{\alpha}^{n^{\prime}}] = 0`,
:math:`[\hat{\mathcal{H}}(n), \hat{\mathcal{I}}_{\alpha}^{n^{\prime}}] = 0`
and
:math:`[\hat{\mathcal{H}}(n), \hat{\mathcal{H}}(n^{\prime})] = 0`
for
:math:`n \ne n^{\prime}`.

Next we give a specific examples which fill the above expressions with life.


Zeeman energy
-------------

When an external magnetic field is applied the term of the form 


.. math::

    \mathcal{H}_{Z-J}(n)
    =
    -
    \sum_{\alpha=1,2,3}
    g_n
    \mu_B
    \hat{J}^{n}_{\alpha}
    H_{\alpha}

or 


.. math::

    \mathcal{H}_{Z-LS}(n)
    =
    -
    \sum_{\alpha=1,2,3}
    \mu_B
    \Bigl(2S^n_{\alpha} + L^n_{\alpha}\Bigr)
    H_{\alpha}

where :math:`\mathbf{J}^n`, :math:`\mathbf{S}^n` and :math:`\mathbf{L}^n` are
the total, spin and orbital angular momentum operators of the ion :math:`n`,
respectively.

Note that by "external magnetic field :math:`\mathbf{H}`" we refer to the
magnetic field in the sample, which is the applied field (e. g. generated by a
coil) diminished by the demagnetizing factor :math:`n_{\text{demag}}` times the
magnetisation :math:`\mathbf{M}` of the sample, i. e.
:math:`\mathbf{H} = \mathbf{H}_{\text{applied}} - n_{\text{demag}} \mathbf{M}`,
e. g. for a spherical sample :math:`n_{\text{demag}} = 1/3`. The unit of 
:math:`\mathbf{H}` is usually chosen to be Tesla, which actually refers to the
quantity :math:`\mu_0 \mathbf{H}` (in SI units).

Magnetic exchange
-----------------

QUESTIONS: 

Is it :math:`\mathcal{J}_{\alpha,\beta}(\mathbf{R}_{n^{\prime}} - \mathbf{R}_{n})`
or :math:`\mathcal{J}(\mathbf{R}_{n^{\prime}} - \mathbf{R}_{n})`?

Is it :math:`\overline{\overline{\mathcal{J}}}_{\alpha,\beta}(\mathbf{R}_{n^{\prime}} - \mathbf{R}_{n})`
or :math:`\overline{\overline{\mathcal{J}}}(\mathbf{R}_{n^{\prime}} - \mathbf{R}_{n})`?



Magnetic exchange interaction is written as either in terms of total angular
momentum operators

.. math::

    \mathcal{H}_{X-J}
    =
    -
    \dfrac{1}{2}
    \sum_{n,n^{\prime},\alpha,\beta}
    \mathcal{J}_{??}(\mathbf{R}_{n^{\prime}} - \mathbf{R}_{n})
    \hat{\mathcal{I}}_{\alpha}^n
    \hat{\mathcal{I}}_{\beta}^{n^{\prime}}

where the operators are understood as
:math:`\hat{\mathcal{I}}_{1}  \leftrightarrow \hat{J}_x`,
:math:`\hat{\mathcal{I}}_{2}  \leftrightarrow \hat{J}_y`,
:math:`\hat{\mathcal{I}}_{3}  \leftrightarrow \hat{J}_z`.
Or in the terms of spin and orbital angular momentum operators


.. math::

    \mathcal{H}_{X-LS}
    =
    -
    \dfrac{1}{2}
    \sum_{n,n^{\prime},\alpha,\beta}
    \overline{\overline{\mathcal{J}}}_{??}(\mathbf{R}_{n^{\prime}} - \mathbf{R}_{n})
    \hat{\mathcal{I}}_{\alpha}^n
    \hat{\mathcal{I}}_{\beta}^{n^{\prime}}

where the operators are understood as
:math:`\hat{\mathcal{I}}_{1}  \leftrightarrow \hat{L}_x`,
:math:`\hat{\mathcal{I}}_{2}  \leftrightarrow \hat{L}_y`,
:math:`\hat{\mathcal{I}}_{3}  \leftrightarrow \hat{L}_z`,
:math:`\hat{\mathcal{I}}_{4}  \leftrightarrow \hat{S}_x`,
:math:`\hat{\mathcal{I}}_{5}  \leftrightarrow \hat{S}_y`,
:math:`\hat{\mathcal{I}}_{6}  \leftrightarrow \hat{S}_z`.

Crystal field
-------------

Single-ion crystal field is written with Stevens operators as

.. math::

    \mathcal{H}_{CF1-S}(n)
    =
    \sum_{lm}
    B_l^m
    O_{lm}(\mathbf{J}^n)

or with Wybourne operators :math:`T_{lm}^n` and Wybourne parameters :math:`L_l^m`
as

.. math::

    \mathcal{H}_{CF1-W}(n)
    =  
    \sum_{lm}
    L_l^m(n)
    T_{lm}^{n}
    
where :math:`T_{lm}^n` is an operator equivalents of real valued spherical
harmonic functions

.. math::
    T_{l0} &= \sqrt{4\pi/(2l+1)}\sum_i Y_{l0}(\Omega_{i_n}),\\
    T_{l,\pm|m|} &= \sqrt{4\pi/(2l+1)}\sum_i\sqrt{\pm 1}[Y_{l,-|m|}(\Omega_{i_n}) \pm (-1)^m Y_{l,|m|}(\Omega_{i_n})]

for the ion :math:`n`. Two-ion crystal field can be written with the Stevens
operators as

.. math::

    \mathcal{H}_{CF2-S}
    =
    -\dfrac{1}{2}
    \sum_{nn^{\prime}}
    \sum_{ll^{\prime}}
    \sum_{mm^{\prime}}
    K_{ll^{\prime}}^{mm^{\prime}}(nn^{\prime})
    O_{lm}(\mathbf{J}^n)
    O_{l^{\prime}m^{\prime}}(\mathbf{J}^{n^{\prime}})

or with the Wybourne operators  as

.. math::

    \mathcal{H}_{CF2-W}
    =
    -
    \dfrac{1}{2}
    \sum_{nn^{\prime}}
    \Biggl[
        \sum_{kk^{\prime}}
        \sum_{qq^{\prime}}
        \mathcal{K}_{kk^{\prime}}^{qq^{\prime}}(nn^{\prime})
        \hat{T}_{kq}^n
        \hat{T}_{k^{\prime}q^{\prime}}^{n^{\prime}}
    \Biggr]

where operators are defined as :math:`\hat{\mathcal{I}}_{\alpha}^n \leftrightarrow O_{lm}(\mathbf{J}^n)`
or :math:`\hat{\mathcal{I}}_{\alpha}^n \leftrightarrow \hat{T}_{kq}^n` and 
index :math:`\alpha` runs over :math:`M` pairs of :math:`(l,m)` or :math:`(k,q)`
respectively. Interaction parameters are either
:math:`\mathcal{J}_{\alpha,\beta}(\mathbf{R}_{n^{\prime}} - \mathbf{R}_{n}) \leftrightarrow K_{ll^{\prime}}^{mm^{\prime}}(nn^{\prime})`
or
:math:`\mathcal{J}_{\alpha,\beta}(\mathbf{R}_{n^{\prime}} - \mathbf{R}_{n}) \leftrightarrow \mathcal{K}_{kk^{\prime}}^{qq^{\prime}}(nn^{\prime})`,
where index :math:`\beta` runs over :math:`M` pairs of :math:`(l^{\prime},m^{\prime})` or :math:`(k^{\prime},q^{\prime})`
respectively.


Exchange striation
------------------


.. math::

    \mathcal{H}_{XS}
    =
    -
    \dfrac{1}{2}
    \sum_{\substack{ij,\alpha\beta\alpha^{\prime}\gamma=1,2,3\\\beta^{\prime}=1-6}}
    \Biggl(
        \dfrac{\partial \mathcal{J}_{\alpha\beta}}{\partial \epsilon_{\beta^{\prime}}}
        +
        \dfrac{\partial \mathcal{J}_{\alpha\beta}}{\partial R^{\alpha^{\prime}}}
        \dfrac{\partial \epsilon_{\alpha^{\prime}\gamma} R_{ij}^{\gamma}}{\partial \epsilon_{\beta^{\prime}}}
    \Biggr)
    \epsilon_{\beta^{\prime}}
    \hat{\mathcal{I}}_{\alpha}^i
    \hat{\mathcal{I}}_{\beta}^j


Phonons
-------

A three dimensional Einstein oscillator (for atom :math:`n`) in a solid can be
described by the following Hamiltonian

.. math::

    \mathcal{H}_{P1}(n)
    =
    \dfrac{a_0^2\hat{\mathbf{w}}_n^2}{2m_n}
    -
    \dfrac{1}{2}
    \sum_{\alpha\beta=1,2,3}
    \hat{u}_{\alpha}^n
    \overline{K}(nn)
    \hat{u}_{\beta}^n

Here :math:`\hat{\mathbf{u}}` is the dimensionless displacement vector 
:math:`\hat{\mathbf{u}} = \hat{\mathbf{P}}_n / a_0 = \Delta \hat{\mathbf{r}}_n / a_0`,
with the Bohr radius :math:`a_0 = 0.5219` Angstrom), :math:`m_n` the mass of the atom
:math:`n`, :math:`\hat{\mathbf{w}}_n = d\hat{\mathbf{u}}_n/dt = \mathbf{p}_n / a_0`
the conjugate momentum to :math:`\hat{\mathbf{u}}_n` and :math:`\overline{\mathbf{K}}(nn)`
the matrix describing the restoring force.

Coupling such oscillators leads to the Hamiltonian

.. math::

    \mathcal{H}_{P2}
    =
    -
    \dfrac{1}{2}
    \sum_{n\ne n^{\prime},\alpha\beta=1,2,3}
    \hat{u}_{\alpha}^n
    \overline{K}_{\alpha\beta}(nn^{\prime})
    \hat{u}_{\beta}^{n^{\prime}}

where operators are defined as :math:`\hat{\mathcal{I}}_{\alpha}^n \leftrightarrow \hat{\mathbf{u}}^n_{\alpha}`
and interaction parameters are
:math:`\mathcal{J}_{\alpha,\beta}(\mathbf{R}_{n^{\prime}} - \mathbf{R}_{n}) \leftrightarrow \overline{K}_{\alpha\beta}(nn^{\prime})`.



Single-ion electrostatic and spin-orbit interaction
---------------------------------------------------

.. math::
    \mathcal{H}_{E-SO}(n)
    =
    \sum_{i_n=1}^{\nu_n}
    \Biggl[
        \dfrac{(p_{i_n})^2}{2m_e}
        -
        \dfrac{Z_n e^2}{4\pi \epsilon_0 |\mathbf{r}_{i_n} - \mathbf{R}_n|}
        +
        \zeta_n
        \mathbf{l}^{i_n}
        \cdot
        \mathbf{s}^{i_n}
    \Biggr]
    +
    \sum_{i_n > j_n=1}^{\nu_n}
    \dfrac{e^2}{4\pi \epsilon_0 |\mathbf{r}_{i_n} - \mathbf{r}_{j_n}|}


Here :math:`\nu_n,Z_n` and :math:`\mathbf{R}_n` denote the number of electrons,
the charge of the nucleus and the position of the ion number :math:`n`,
respectively, for each electron being :math:`p` the momentum, :math:`m_e`
the mass, :math:`e` the charge and :math:`\mathbf{r}` the location. Spin orbit
coupling is written in terms of the orbital momentum :math:`\mathbf{l}` and spin
:math:`\mathbf{s}` of the individual electrons. 

Magneto-elastic interaction
---------------------------

.. math::

    \mathcal{H}_{ME1}(n)
    =
    -
    \sum_{\substack{\alpha=1,\dots,6,\\\gamma=1,2,3}}
    G^{\alpha\gamma}_{\text{mix}}(n)
    \epsilon_{\alpha}
    \hat{u}_n^{\gamma}
    -
    \sum_{\alpha=1,\dots,6, lm}
    G^{\alpha\gamma}_{\text{cfph}}(n)
    \epsilon_{\alpha}
    O_{lm}(\hat{\mathbf{J}}^n)

and 


.. math::

    \mathcal{H}_{ME2}
    =
    -
    \sum_{\substack{n<n^{\prime},lm,\\\alpha=1,2,3}}
    \Gamma^{\alpha\gamma}(nn^{\prime})
    \hat{u}_n^{\alpha}
    O_{lm}(\hat{\mathbf{J}}^{n^{\prime}})


Unclear terms
-------------

.. math::

    \hat{H}
    =
    \sum_{i,\gamma}
    B_{\gamma}(i,0,\dots,0)
    O_{\gamma}(\mathbf{J}_i)
    +
    \dfrac{1}{2}
    \sum_{\alpha\gamma=1-6}
    c^{\alpha\gamma}
    \epsilon_{\alpha}
    \epsilon_{\gamma}
    -
    \sum_{\alpha=1,\dots,6}
    \sigma_{\alpha}
    \epsilon_{\alpha}



Convention
==========


================= ===
================= ===
Spin normalized   no
Multiple counting yes
================= ===
