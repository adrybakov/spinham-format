.. _zoo_mcphase:

*******
McPhase
*******

========= ======================================================================
========= ======================================================================
Status    Draft
Links     `Web <https://mcphase.github.io/webpage/>`_
Languages C++, Fortran, Perl, Java
========= ======================================================================

Spin Hamiltonian
================ 

The spin Hamiltonian is in general:

.. math::

    \hat{\mathcal{H}}
    =
    \sum_{n=1}^{N}
    \hat{\mathcal{H}}(n)
    -
    \dfrac{1}{2}
    \sum_{n,n^{\prime},\alpha,\beta}
    \mathcal{J}_{\alpha,\beta}(\mathbf{R}_{n^{\prime}} - \mathbf{R}_{n})
    \hat{\mathcal{I}}_{\alpha}^n
    \hat{\mathcal{I}}_{\beta}^{n^{\prime}}

The first term :math:`\hat{\mathcal{H}}(n)` denotes the Hamiltonian of a
subsystem :math:`n` (e. g. an ion, or cluster of ions). The second term
describes a bilinear interaction between different subsystems through the
operators
:math:`\hat{\mathcal{I}}_{\alpha}^n`,
with
:math:`\alpha = 1, 2, \dots, m`.
The operators
:math:`\hat{\mathcal{H}}(n)`
and
:math:`\hat{\mathcal{I}}_{\alpha}^n`
act in the subspace :math:`n` of the Hilbert space, i. e. 
:math:`[\hat{\mathcal{I}}_{\alpha}^n, \hat{\mathcal{I}}_{\alpha}^{n^{\prime}}] = 0`,
:math:`[\hat{\mathcal{H}}(n), \hat{\mathcal{I}}_{\alpha}^{n^{\prime}}] = 0`
and
:math:`[\hat{\mathcal{H}}(n), \hat{\mathcal{H}}(n^{\prime})] = 0`
for
:math:`n \ne n^{\prime}`.
For example in the case of a Heisenberg exchange between magnetic ions we would
identify the set of operators with :math:`\alpha = 1,2,3` with the three
components of spin:
:math:`\hat{\mathcal{I}}_{1}  \leftrightarrow \hat{S}_x`,
:math:`\hat{\mathcal{I}}_{2}  \leftrightarrow \hat{S}_y`,
:math:`\hat{\mathcal{I}}_{3}  \leftrightarrow \hat{S}_z`.

In the following I give specific examples which fill the above expressions with life:

1) For magnetic systems the single and two ion terms can be specialised:

.. math::

    \mathcal{H}
    =
    \sum_{n,lm}
    B_l^m
    O_{lm}(\mathbf{J}^n)
    -
    \dfrac{1}{2}
    \sum_{nn^{\prime}}
    \mathcal{J}(nn^{\prime})
    \mathbf{J}^n
    \mathbf{J}^{n^{\prime}}
    -
    \sum_n
    g_{J_n}
    \mu_B
    \mathbf{J}^n
    \mathbf{H}

The first term describes the crystal field (Stevens Operators :math:`O_l^m`),
the second the magnetic exchange interaction, the third the Zeeman energy if an
external magnetic field is applied. Note that by "external magnetic field 
:math:`\mathbf{H}`" we refer to the magnetic field in the sample, which is the
applied field (e. g. generated by a coil) diminished by the demagnetizing factor
:math:`n_{\text{demag}}` times the magnetisation :math:`\mathbf{M}` of the sample,
i. e. :math:`\mathbf{H} = \mathbf{H}_{\text{applied}} - n_{\text{demag}} \mathbf{M}`,
e. g. for a spherical sample :math:`n_{\text{demag}} = 1/3`. The unit of 
:math:`\mathbf{H}` is usually chosen to be Tesla, which actually refers to the
quantity :math:`\mu_0 \mathbf{H}` (in SI units).

.. math::

    \mathcal{H}_{JJ}
    =
    -\dfrac{1}{2}
    \sum_{nn^{\prime}}
    \sum_{ll^{\prime}}
    \sum_{mm^{\prime}}
    K_{ll^{\prime}}^{mm^{\prime}}(nn^{\prime})
    O_{lm}(\mathbf{J}^n)
    O_{l^{\prime}m^{\prime}}(\mathbf{J}^{n^{\prime}})

For some rare earth ions and for transition metals or actinides it is necessary
to include more singleion ion states with different L,S into the calculation.
This can be done in intermediate coupling using the module *iclion*, which 
explicitely includes electrostatic and spin orbit interactions for each ion:

.. math::
    \mathcal{H}
    =&
    \sum_n
    \Biggl\{
        \sum_{i_n=1}^{\nu_n}
        \Biggl[
            \dfrac{(p_{i_n})^2}{2m_e}
            -
            \dfrac{Z_n e^2}{4\pi \epsilon_0 |\mathbf{r}_{i_n} - \mathbf{R}_n|}
            +
            \zeta_n
            \mathbf{l}^{i_n}
            \cdot
            \mathbf{s}^{i_n}
            +
            \sum_{lm}
            L_l^m(n)
            T_{lm}^{n}
        \Biggr]
        +
        \sum_{i_n > j_n=1}^{\nu_n}
        \dfrac{e^2}{4\pi \epsilon_0 |\mathbf{r}_{i_n} - \mathbf{r}_{j_n}|}
    \Biggr\}
    \\&-
    \sum_n
    \mu_B
    ( 2\mathbf{S}^n + \mathbf{L}^n )\mathbf{H}
    \\&-
    \dfrac{1}{2}
    \sum_{nn^{\prime}}
    \Biggl[
        (\hat{\mathbf{L}}^n, \hat{\mathbf{S}}^n)
        \overline{\overline{\mathcal{J}}}(nn^{\prime})
        \begin{pmatrix}
            \hat{\mathbf{L}}^{n^{\prime}} \\
            \hat{\mathbf{S}}^{n^{\prime}}
        \end{pmatrix}
        +
        \sum_{kk^{\prime}}
        \sum_{qq^{\prime}}
        \mathcal{K}_{kk^{\prime}}^{qq^{\prime}}(nn^{\prime})
        \hat{T}_{kq}^n
        \hat{T}_{k^{\prime}q^{\prime}}^{n^{\prime}}
    \Biggr]


Here :math:`\nu_n,Z_n` and :math:`\mathbf{R}_n` denote the number of electrons,
the charge of the nucleus and the position of the ion number :math:`n`,
respectively, for each electron being :math:`p` the momentum, :math:`m_e`
the mass, :math:`e` the charge and :math:`\mathbf{r}` the location. Spin orbit
coupling is written in terms of the orbital momentum :math:`\mathbf{l}` and spin
:math:`\mathbf{s}` of the individual electrons. The Zeeman interaction and two
ion interaction are written in terms of the (inverse) total spin
:math:`\mathbf{S}_n` and (inverse) total orbital momentum :math:`\mathbf{L}_n`
of ion number :math:`n`. The crystal field in intermediate coupling is written
in terms of Wybourne parameters :math:`L_l^m` and Wybourne operators
:math:`T_{lm}^n`, operator equivalents of real valued spherical harmonic
functions :math:`T_{l0} = \sqrt{4\pi/(2l+1)}\sum_i Y_{l0}(\Omega_{i_n})`,
:math:`T_{l,\pm|m|} = \sqrt{4\pi/(2l+1)}\sum_i\sqrt{\pm 1}[Y_{l,-|m|}(\Omega_{i_n}) \pm (-1)^m Y_{l,|m|}(\Omega_{i_n})]`
for the ion :math:`n`.

2) And for phonons similar:

A three dimensional Einstein oscillator (for atom :math:`i`) in a solid can be
described by the following Hamiltonian

.. math::

    \hat{H}_E
    =
    \dfrac{a_0^2\hat{\mathbf{w}}_i^2}{2m_i}
    -
    \dfrac{1}{2}
    \hat{\mathbf{u}}_i^T
    \overline{K}(ii)
    \hat{\mathbf{u}}_i

Here :math:`\hat{\mathbf{u}}` is the dimensionless displacement vector 
:math:`\hat{\mathbf{u}} = \hat{\mathbf{P}}_i / a_0 = \Delta \hat{\mathbf{r}}_i / a_0`,
with the Bohr radius :math:`a_0 = 0.5219 Angstrom`), :math:`m_i` the mass of the atom
:math:`i`, :math:`\hat{\mathbf{w}}_i = d\hat{\mathbf{u}}_i/dt = \mathbf{p}_i / a_0`
the conjugate momentum to :math:`\hat{\mathbf{u}}_i` and :math:`\overline{K}(ii)`
the Matrix describing the restoring force.

Coupling such oscillators leads to the Hamiltonian

.. math::

    \hat{H}_{\text{phon}}
    =
    \sum_i
    \hat{H}_E(i)
    -
    \dfrac{1}{2}
    \sum_{i\ne i^{\prime}}
    \hat{\mathbf{u}}_i^T
    \overline{K}(ii^{\prime})
    \hat{\mathbf{u}}_{i^{\prime}}

3) For interacting magnetic-phonon systems and adding magneto elastic terms the
Hamiltonian is:

.. math::

    \hat{H}
    =&
    \sum_{i,\gamma}
    B_{\gamma}(i,0,\dots,0)
    O_{\gamma}(\mathbf{J}_i)
    -
    \sum_i
    g_{J_i}
    \mu_B
    \hat{\mathbf{J}}_i
    \mathbf{H}
    +\\&+
    \sum_i
    \hat{H}_E(i)
    +
    \dfrac{1}{2}
    \sum_{\alpha\gamma=1-6}
    c^{\alpha\gamma}
    \epsilon_{\alpha}
    \epsilon_{\gamma}
    -
    \sum_{\alpha=1,\dots,6}
    \sigma_{\alpha}
    \epsilon_{\alpha}
    -\\&-
    \dfrac{1}{2}
    \sum_{i \ne j, \alpha,\beta}
    K_{\alpha,\beta}(ij)
    \hat{u}_i^{\alpha}
    \hat{u}_j^{\beta}
    -
    \sum_{i<j,\alpha=1,2,3,\gamma}
    \Gamma^{\alpha\gamma}(ij)
    \hat{u}_i^{\alpha}
    O_{\gamma}(\hat{\mathbf{J}}_j)
    \\&-
    \sum_{i,\alpha=1-6,\gamma=1,2,3}
    G^{\alpha\gamma}_{mix}(i)
    \epsilon_{\alpha}
    \hat{u}_i^{\gamma}
    -\\&-
    \sum_{i,\alpha=1-6,\gamma=1,\dots}
    G^{\alpha\gamma}_{\text{cfph}}(i)
    \epsilon_{\alpha}
    O_{\gamma}(\hat{\mathbf{J}}_i)

4) â€¦ and adding exchange striation we use:


.. math::

    \hat{H}
    =
    \hat{H}_{\text{tot}}
    -
    \dfrac{1}{2}
    \sum_{ij,\alpha\beta}
    \mathcal{J}_{\alpha\beta}(\mathbf{R}_{ij})
    \hat{\mathcal{I}}_{\alpha}^i
    \hat{\mathcal{I}}_{\beta}^j
    -
    \dfrac{1}{2}
    \sum_{\substack{ij,\alpha\beta\alpha^{\prime}\gamma=1,2,3\\\beta^{\prime}=1-6}}
    \Biggl(
        \dfrac{\partial \mathcal{J}_{\alpha\beta}}{\partial \epsilon_{\beta^{\prime}}}
        +
        \dfrac{\partial \mathcal{J}_{\alpha\beta}}{\partial R^{\alpha^{\prime}}}
        \dfrac{\partial \epsilon_{\alpha^{\prime}\gamma} R_{ij}^{\gamma}}{\partial \epsilon_{\beta^{\prime}}}
    \Biggr)
    \epsilon_{\beta^{\prime}}
    \hat{\mathcal{I}}_{\alpha}^i
    \hat{\mathcal{I}}_{\beta}^j

Convention
==========


================= ===
================= ===
Spin normalized   no
Multiple counting yes
================= ===
